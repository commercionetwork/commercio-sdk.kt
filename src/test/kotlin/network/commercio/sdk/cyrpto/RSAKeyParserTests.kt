package network.commercio.sdk.cyrpto

import network.commercio.sdk.crypto.KeysHelper
import network.commercio.sdk.crypto.RSAKeyParser
import org.junit.Assert.assertEquals
import org.junit.Test

/**
 * Tests for [KeysHelper].
 */
class RSAKeyParserTests {


    @Test
    fun getRSAPrivateKeyFromPem() {

        val privateKeyPem = """-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDEhvOUpSsU2DBO
qmIaaeoaRT9uJacVfTKDzqhwscAXLag26xil0rMb3p23olCAtywFhrcB7HR6y8aj
UhCTqVEMB2tUvq13OgPh1QwttIr6XU1IQEOkAHbv3RE9tRfsWHMxcYEvilqFfWeM
crQ9TNADtJuwKE8xu4M2X0VXYp3vNLX9lg3mmbWwvKeAh/Wa6YbMSHSHi1abEAr6
INki/5axbRAtbl/72Wsc8obY821Q+3owCSqVCLxdYHNLlz0SnnYAqQvyk0uXkLlZ
YuMFA4LLPPiSk7pTYvPN8kUhD5mywD1b46grWQcm/wKr9++cbvavXU3DVZpnGGhx
dFs4fuRNAgMBAAECggEACK8t9FOYI8Op3tAIpcIoZiDJPMTNLVXq9YgcSV6RbnTG
Cic5X5p/76tWrNavWADAIT5it+MLAqIelPj7YosI2c86HvSOFcaqhUA02ZAw0/9r
etXcJ1Md7luGd4OZGwiNjpHFc6RZe6ye9sXa0Rqj1oYUmyQs27W9hpmPJt1kvT0z
MyzGH6NXE/OkdGmVBEtrVGmj8H3R7o6TuBc81Fzgv3k8LqmbGdgKguXkuzY0RegA
voaW9KAzGUAtTzuhmxijxfXIR0kri51PIKXsWufT7Oc5bcTPfn9huRYBfNXX8oHV
iKyC3OOMXm0aOhs5jQYoAT1RiLiWNTuK2ntr5tW+wQKBgQDs5wChxGiyX0QIw7js
umLDZK1sfEvXnmmHdyyGSgvunOnIuOrBPb4uxkM39Cv6BrKbqKXBsgleaDO3oNAa
w7hlaNJai+ofbE9gdORAa74AMXAgAB3nmSs1ysP7nOIx5FPiLJDTdND16V8YG1CP
yXZn7yu7rqR8hK0D9jrK188jJwKBgQDUXrf1pOQLKOva19ruMRtOBv1Mc8FnQ1Ld
cQNyWjcYIzA3MvET1HVeuxGjqGi7xD/LkKP8Z1C3pEQyhqDfPQVH4Ip5Fen7qFnb
MdaXNeVvy7tQWgqSyeAIOahm94HYN6LOO98/X7BD+7oGNxEg3OW58TnPx2voVNQM
Qhh4Ik8VawKBgCFRR6x4lATqEwZsiFh6yiMSyLUmMgBsHglYQGHOjikL1nFNWG6/
AT1Q0ulOpNSwFnR/3ngEUv79BrD/o+Tvu8I/YL4tSUsMD4nQRr2sqXcbfNpzScFl
sEcLck6zvLgplYaMn/2tQyoinSYlyUm/mrB5WZw2rpl4i2CwQ4p9mXsnAoGANri9
YB9/31xJAdfzAsNGjOGCLUv6ftg7JvIy+ClE3wRaLS8ELZ7mK2W6ktgXPKLB6Xs4
thYNF3TNWdOU6lD35mB2beL2qrDjjnaWG9p4Z0kw1/CLnu1Du/rXaMjH/WXAnrGQ
weyvJ6VadrWDxVsGGtaMlfyF0pThGtOBKJt2k0cCgYEArfQVouF/daHoTwB1BX+u
LIuxTinZV4Ek3xl5E3LKo4rrY74I2+IbMdSt9E7q8k47BlEnxhixwivjUjsFFIqG
s+vl7a3lB5pdf+Igq8ukfgYMvrK0K3ptl/sTcs4hT0FzXo+6rUKwxHjZxw4tynwz
DqNPFV4qk2gvpDAQ5uvBuX0=
-----END PRIVATE KEY-----
"""

        val privateExponent =
            "1096290675386890340840274365469481191043516132842373713860718012325257739600668151604969207030091476077896547442257849539225995044661715223294752718702187703093758186304940234131544417496359413639195721993157737656724579376602583817095197569347674155926012440068215717328589246617036905307232488935165245601248203509798114830488894654226117605150220185336085766293713777814873490823114716535469546689745768848509398076383238076827703567899126194640270741178067671956660575359598364119074038698201432222826164156998112727881432908551358236199498867168240251130317678187647627324635339787944007770086112918480100900545"
        val modulus =
            "24809254831778533241591526619396888403804874584976051825031034659447657624381556854880824213097757274764194071037034767006993797390191585148158911921818119992284402712661211368880879312658462324472365342633141800003024433219752602079063523170697003161920952101087932826852124811996114524558044070215443612213369189157600451357133985788102609773418903878932427813111004640069485706428437787047901845210017757351542447601967502567663323903601844786636220048318587498695646508037062119612704744480843960617709035169723800106043385125638656189440521133427969959784141041995621812784516492631527427695263299480587606090829"


        val privateKey = RSAKeyParser.parseRSAPrivateKeyFromPem(privateKeyPem)
        assertEquals(privateExponent, privateKey.privateExponent.toString())
        assertEquals(modulus, privateKey.modulus.toString())
        assertEquals(null, privateKey.params)
        assertEquals("RSA", privateKey.algorithm)
        assertEquals("PKCS#8", privateKey.format)
    }
}